---
title: 号码无效字串修改
date: 2017-04-10 16:37:23
tags: 工作
categories:
    - 工作
    - BUG
password: 
---

# 关键LOG

```
10-23 15:15:43.061 I/InCall  ( 5120): InCallActivity - Show Dialog: Invalid number format (incomplete number)
```
这个就是提示框显示的地方，关键是里面的字串为什么是英文？代码中字串已经有了中文资源的。下面我们先看下具体的逻辑

# 代码逻辑

# 最终方案

因为怀疑在`packages/apps/Phonecomm`中有做客制化，导致我这边无论怎么修改都不生效。最后没有办法了，只能使用规避方案，就是在自己可以操作的代码中直接把引用的资源替换掉。具体如下

**修改前**

```
import com.android.phone.common.R;
case android.telephony.DisconnectCause.INVALID_NUMBER:
    resourceId = R.string.callFailed_invalid_number_format;
    break;

```

**修改后**

```
case android.telephony.DisconnectCause.INVALID_NUMBER:
    resourceId = com.android.phone.R.string.callFailed_invalid_number_format_hq;
    break;

```

然后在`packages/services/Telephony`下添加新的资源文件即可

这里有个知识点，就是资源引用的具体方法-**包名+R+资源名**，如果类中已经导入了这个包，那么可以直接使用**R+资源**,或者直接用**包名+R**的方式，这时候也不会去引用导包处的资源的



